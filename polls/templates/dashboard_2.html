<!DOCTYPE html>
<html>

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>zyx | 数据图表查询</title>

    <link href="/static/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/bootstrap/font-awesome/css/font-awesome.css" rel="stylesheet">

    <link href="/static/bootstrap/css/animate.css" rel="stylesheet">
    <link href="/static/bootstrap/css/style.css" rel="stylesheet">

    <link href="/static/bootstrap/css/plugins/datapicker/datepicker3.css" rel="stylesheet">
    
    <script src="/static/echarts.min.js"></script>

</head>

<body>
    <div id="wrapper">
    <nav class="navbar-default navbar-static-side" role="navigation">
        <div class="sidebar-collapse">
            <ul class="nav metismenu" id="side-menu">
                <li class="nav-header">
                    <div class="dropdown profile-element">
                        <img alt="image" class="rounded-circle" src="/static/bootstrap/img/zyx.jpg"/>
                        <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                            <span class="block m-t-xs font-bold">ZHONG YIXIN</span>
                            <span class="text-muted text-xs block">管理员 <b class="caret"></b></span>
                        </a>
                        <ul class="dropdown-menu animated fadeInRight m-t-xs">
                            <li><a class="dropdown-item" href="profile.html">个人信息</a></li>
                            <li><a class="dropdown-item" href="contacts.html">好友</a></li>
                            <li><a class="dropdown-item" href="mailbox.html">信箱</a></li>
                            <li class="dropdown-divider"></li>
                            <li><a class="dropdown-item" href="login.html">登出</a></li>
                        </ul>
                    </div>
                    <div class="logo-element">
                        IN+
                    </div>
                </li>
                <li>
                    <a href="/map_page/"><i class="fa fa-files-o"></i> <span class="nav-label">监管区域地图</span></a>
                </li>
                <li class="active">
                    <a href="/dashboard_2/"><i class="fa fa-bar-chart-o"></i> <span class="nav-label">数据图表查询</span> </a>
                </li>
                <li>
                    <a href="/predict/"><i class="fa fa-desktop"></i> <span class="nav-label">单路口信号预测</span></a>
                </li>
                <li>
                    <a href="/predict_m/"><i class="fa fa-flask"></i></i> <span class="nav-label">多路口协调预测</span></a>
                </li>
                <li>
                    <a href="/test/"><i class="fa fa-th-large"></i> <span class="nav-label">测试页</span>  </a>
                </li>
            </ul>

        </div>
    </nav>

        <div id="page-wrapper" class="gray-bg">
        <div class="row border-bottom">
        <nav class="navbar navbar-static-top white-bg" role="navigation" style="margin-bottom: 0">
        <div class="navbar-header">
            <a class="navbar-minimalize minimalize-styl-2 btn btn-primary " href="#"><i class="fa fa-bars"></i> </a>
            <form role="search" class="navbar-form-custom" action="search_results.html">
                <div class="form-group">
                    <input type="text" placeholder="请输入搜索内容" class="form-control" name="top-search" id="top-search">
                </div>
            </form>
        </div>
            <ul class="nav navbar-top-links navbar-right">
                <li>
                    <span class="m-r-sm text-muted welcome-message">欢迎来到xxx道路交通信号调控方案及预测管理后台</span>
                </li>
                <li>
                    <a href="/">
                        <i class="fa fa-sign-out"></i> 注销
                    </a>
                </li>
                
            </ul>

        </nav>
        </div>
            <div class="wrapper wrapper-content">
        <div class="row">
                    <div class="col-lg-3">
                        <div class="ibox ">
                            <div class="ibox-title">
                                <span class="label label-success float-right">当天</span>
                                <h5>该车道当日最大饱和度</h5>
                            </div>
                            <div class="ibox-content">
                                <h1 class="no-margins">{{MAX_DS}}</h1>
                                <div class="stat-percent font-bold text-success">{{precent1}}% <i class="fa fa-bolt"></i></div>
                                <small>{{ddate}}</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3">
                        <div class="ibox ">
                            <div class="ibox-title">
                                <span class="label label-info float-right">本月</span>
                                <h5>该车道当月最大饱和度</h5>
                            </div>
                            <div class="ibox-content">
                                <h1 class="no-margins">{{M_MAX_DS}}</h1>
                                <div class="stat-percent font-bold text-info">  <i class="fa fa-level-up"></i></div>
                                <small>11/2018</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3">
                        <div class="ibox ">
                            <div class="ibox-title">
                                <span class="label label-primary float-right">当天</span>
                                <h5>该车道当日最大流量</h5>
                            </div>
                            <div class="ibox-content">
                                <h1 class="no-margins">{{MAX_actualVolume}}</h1>
                                <div class="stat-percent font-bold text-navy">{{precent2}}% <i class="fa fa-level-up"></i></div>
                                <small>{{ddate}}</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3">
                        <div class="ibox ">
                            <div class="ibox-title">
                                <span class="label label-danger float-right">本月</span>
                                <h5>该车道当月最大流量</h5>
                            </div>
                            <div class="ibox-content">
                                <h1 class="no-margins">{{M_MAX_actualVolume}}</h1>
                                <div class="stat-percent font-bold text-danger">  <i class="fa fa-level-down"></i></div>
                                <small>11/2018</small>
                            </div>
                        </div>
            </div>
        </div>
        <div class="row">
                    <div class="col-lg-12">
                        <div class="ibox ">
                            <div class="ibox-title">
                                <h5>{{ddate}} {{cross}}号路口{{detector}}号车道流量与饱和度数据表</h5>
                            </div>
                            <div class="ibox-content">
                                <div class="row">
                                <div class="col-lg-9">
                                    <div id="test_bar" style="width: 1000px;height:600px;"></div>
                                </div>
                                
                                <div class="col-lg-3">
                                    <form method="post" action="/search_forms/">
                                    <div class="ibox-content">
                                            <div class="col-md-10">
                                    <div class="form-group" id="data_1">
                                        <label class="font-normal">请选择查询日期</label>
                                        <div class="input-group date">
                                            <span class="input-group-addon"><i class="fa fa-calendar"></i></span><input name="bdate" type="text" class="form-control" value={{ddate}}>
                                        </div>
                                    </div>
                                    </div>
                                    </div>
                                        <div class="ibox-content">
                                         <div class="col-md-10">
                                                <p>
                                                    请选择查询路口
                                                </p>
                                                <select name="bcross" class="select2_demo_3 form-control">
                                                    <option>请选择一个路口</option>
                                                    <option value="8 延安路-体育场路">8 延安路-体育场路</option>
                                                    <option value="9 中山北路-体育场路">9 中山北路-体育场路</option>
                                                    <option value="13 武林路-凤起路">13 武林路-凤起路</option>
                                                    <option value="14 延安路-凤起路">14 延安路-凤起路</option>
                                                    <option value="15 中山北路-凤起路">15 中山北路-凤起路</option>
                                                    <option value="19 延安路-庆春路">19 延安路-庆春路</option>
                                                    <option value="20 浣纱路-庆春路">20 浣纱路-庆春路</option>
                                                    <option value="22 中河中路-庆春路">22 中河中路-庆春路</option>
                                                    <option value="27 建国北路-凤起路">27 建国北路-凤起路</option>
                                                    <option value="68 体育场路-环城东路">68 体育场路-环城东路</option>
                                                    <option value="70 建国北路-朝晖路">70 建国北路-朝晖路</option>
                                                    <option value="71 文晖路-河东路">71 文晖路-河东路</option>
                                                    <option value="79 新市街-上塘路">79 新市街-上塘路</option>
                                                    <option value="106 环城北路-朝晖路">106 环城北路-朝晖路</option>
                                                    <option value="157 上塘路-朝晖路">157 上塘路-朝晖路</option>
                                                    <option value="194 绍兴路-德胜路">194 绍兴路-德胜路</option>
                                                    <option value="195 绍兴路400弄-绍兴路">195 绍兴路400弄-绍兴路</option>
                                                    <option value="199 东新路-德胜路">199 东新路-德胜路</option>
                                                    <option value="201 西文街-东新路">201 西文街-东新路</option>
                                                    <option value="263 中诸葛路-德胜中路">263 中诸葛路-德胜中路</option>
                                                    <option value="319 石大路-华中路">319 石大路-华中路</option>
                                                    <option value="320 石祥路-长浜路">320 石祥路-长浜路</option>
                                                    <option value="321 石祥路-东新路">321 石祥路-东新路</option>
                                                    <option value="336 新汇路-石大路">336 新汇路-石大路</option>
                                                    <option value="405 中山北路-朝晖路">405 中山北路-朝晖路</option>
                                                    <option value="471 颜三路-碧桃巷">471 颜三路-碧桃巷</option>
                                                    <option value="472 颜三路-白石巷">472 颜三路-白石巷</option>
                                                    <option value="474 西文街-白石巷">474 西文街-白石巷</option>
                                                    <option value="475 香积寺路-碧桃巷">475 香积寺路-碧桃巷</option>
                                                    <option value="564 新汇路-八角亭街">564 新汇路-八角亭街</option>
                                                    <option value="565 新汇路-长华街">565 新汇路-长华街</option>
                                                    <option value="647 重机巷-新天地街">647 重机巷-新天地街</option>
                                                    <option value="754 华中南路-长城街">754 华中南路-长城街</option>
                                                    <option value="755 俞章路-华中南路">755 俞章路-华中南路</option>
                                                    <option value="920 东文路-安桥路">920 东文路-安桥路</option>
                                                    <option value="968 载歌巷-香积寺路">968 载歌巷-香积寺路</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="ibox-content">
                                            <div class="col-md-10">
                                                <p>
                                                    请选择查询车道号
                                                </p>
                                                <select name="bdetector" class="select2_demo_3 form-control">
                                                    <option>选择一个车道号</option>
                                                    {% for month in months %}
                                                    <option value="{{ month}}">{{ month }}</option>
                                                    {% endfor %}
                                                </select>
                                            </div>
                                        </div>
                                            {{error}}<br>
                                                <button type="submit" class="btn btn-primary block full-width m-b">查询</button>
                                            {% csrf_token %}
                                        </form>
                                    </div>
                                    
                                </div>

                                
                                </div>
                                
                            </div>
                        </div>
                    </div>
                    </div>
                </div>
                </div>
                
                
        
        </div>
        
    </div>

    <!-- Mainly scripts -->
    <script src="/static/bootstrap/js/jquery-3.1.1.min.js"></script>
    <script src="/static/bootstrap/js/popper.min.js"></script>
    <script src="/static/bootstrap/js/bootstrap.js"></script>
    <script src="/static/bootstrap/js/plugins/metisMenu/jquery.metisMenu.js"></script>
    <script src="/static/bootstrap/js/plugins/slimscroll/jquery.slimscroll.min.js"></script>


    <!-- Peity -->
    <script src="/static/bootstrap/js/plugins/peity/jquery.peity.min.js"></script>
    <script src="/static/bootstrap/js/demo/peity-demo.js"></script>

    <!-- Custom and plugin javascript -->
    <script src="/static/bootstrap/js/inspinia.js"></script>
    <script src="/static/bootstrap/js/plugins/pace/pace.min.js"></script>

    <!-- jQuery UI -->
    <script src="/static/bootstrap/js/plugins/jquery-ui/jquery-ui.min.js"></script>

    <!-- Jvectormap -->
    <script src="/static/bootstrap/js/plugins/jvectormap/jquery-jvectormap-2.0.2.min.js"></script>
    <script src="/static/bootstrap/js/plugins/jvectormap/jquery-jvectormap-world-mill-en.js"></script>

    <!-- EayPIE -->
    <script src="/static/bootstrap/js/plugins/easypiechart/jquery.easypiechart.js"></script>

    <!-- Sparkline -->
    <script src="/static/bootstrap/js/plugins/sparkline/jquery.sparkline.min.js"></script>

    <!-- Sparkline demo data  -->
    <script src="/static/bootstrap/js/demo/sparkline-demo.js"></script>

   <!-- Data picker -->
   <script src="/static/bootstrap/js/plugins/datapicker/bootstrap-datepicker.js"></script>


    <script>
        $(document).ready(function(){
            var mem = $('#data_1 .input-group.date').datepicker({
                todayBtn: "linked",
                keyboardNavigation: false,
                forceParse: false,
                calendarWeeks: true,
                autoclose: true
            });
        });
    </script>
<script type="text/javascript">
    var dom = document.getElementById("test_bar");
    var myChart = echarts.init(dom);
    var app = {};
    option = null;
    
    option = {               //图表正上方属性选项
        legend: {
            data: ['饱和度', '流量','PL值'],
            align: 'left'
        },
        toolbox: {          //工具箱设置
            feature: {
                magicType: {
                    type: ['stack', 'tiled'] //堆叠、平铺切换
                }, 
                dataView: {},          //数据视图显示
                saveAsImage: {        //保存为图片
                    pixelRatio: 2 
                }
            }
        },
        tooltip: {},            //鼠标移过时的数据详情浮窗
        xAxis: {              //横坐标设置
            data: {{ time_lst|safe }},   //ime_lst是由view层从数据库返回给模板层的数据列表，是各属性数据值的采集时间表
            silent: false,
            splitLine: {
                show: false
            }
        },
        yAxis: {             //纵坐标采取默认形式，即随数据值自适应变化
        },
        series: [{
            name: '饱和度',     //饱和度数据导入展示
            type: 'bar',       //柱状图类型
            data: {{ ds_lst|safe }},    //ds_lst为读取到的对应路口饱和度表
            animationDelay: function (idx) {
                return idx * 10;
            }
        }, {
            name: '流量',     //流量数据导入展示
            type: 'bar',
            data: {{ actualVolume_lst|safe }},  //actualVolume_lst为流量表
            animationDelay: function (idx) {
                return idx * 10 + 100;
            }
        },{
            name: 'PL值',   //方案标签数据导入展示
            type: 'bar',
            data: {{ pl_lst|safe }},   //pl_lst为历史方案表
            animationDelay: function (idx) {
                return idx * 10 + 100;
            }
        }],
        animationEasing: 'elasticOut',
        animationDelayUpdate: function (idx) {
            return idx * 5;
        }
    };
    if (option && typeof option === "object") {
        myChart.setOption(option, true);
    }
           </script>
</body>
</html>
